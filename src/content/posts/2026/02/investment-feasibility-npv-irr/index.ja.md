---
layout: /src/layouts/Layout.astro
title: "投資妥当性分析：NPVとIRR自動計算エクセル"
author: "Zzabbis"
date: "2026-02-04"
updatedDate: "2026-02-04"
category: "業務自動化"
description: "このプロジェクト、本当に利益が出る？投資の意思決定に不可欠な正味現在価値(NPV)と内部収益率(IRR)をExcelで瞬時に計算するプロンプト。"
tags: ["エクセル", "投資分析", "NPV", "IRR"]
---

# 📝 投資妥当性分析：NPVとIRR自動計算エクセル

- **🎯 推奨対象:** マーケター、新規事業担当者、プロジェクトマネージャー
- **⏱️ 所要時間:** 30分 → 1分
- **🤖 推奨モデル:** すべての対話型AI (ChatGPT, Claude, Geminiなど)

- ⭐ **難易度:** ⭐⭐☆☆☆
- ⚡️ **効果性:** ⭐⭐⭐⭐⭐
- 🚀 **活用度:** ⭐⭐⭐⭐☆

> _「今1億円を投資して、5年後に2億円稼げるとしたら、それは本当に『儲かる』のでしょうか？実は、金利によって答えは変わります。」_

単に最終的な収益額だけを見て判断してはいけません。お金の価値は時間とともに変化するからです。企業における投資判断のゴールデンルールである**NPV（正味現在価値）**と**IRR（内部収益率）**。概念自体は難解に思えますが、Excelの関数を使えば誰でも簡単に計算できます。このプロンプトを使えば、AIがあなたのプロジェクトに合わせた完璧な計算式と判断基準を提示してくれます。

---

## ⚡️ 3行要約 (TL;DR)

1. キャッシュフロー（Cash Flow）データを基にNPVとIRRの概念を理解する
2. Excelの `NPV`、`IRR` 関数を活用した自動計算式を生成する
3. 割引率（金利）の変化に応じた、明確な投資判断基準を獲得する

---

## 🚀 解決策：「投資審査役AI」

### 🥉 Basic Version (基本形)

手早く結果だけを知りたい場合に使用してください。

> **役割:** あなたは`[財務モデリングの専門家]`です。
> **タスク:** Excelを使用して、新規プロジェクトの投資意思決定の核心指標である正味現在価値(NPV)と内部収益率(IRR)を簡単に計算する数式を作成してください。

<br>

### 🥇 Pro Version (専門家形)

より正確で詳細な分析結果が必要な場合に使用してください。

> **役割 (Role):** あなたは`[財務モデリングの専門家]`です。
>
> **状況 (Context):**
>
> - 背景: Excelで新規プロジェクトの投資妥当性を分析しようとしています。
> - 目標: 以下のデータに基づいて、正確なNPVとIRRを計算し、投資判断を下すこと。
>
> **データ (Data):**
>
> - 初期投資額（0年目）: -1億円（B2セル）
> - 予想収益（1〜5年目）: 毎年3,000万円（B3〜B7セル）
> - 割引率（要求収益率）: 10%（C2セル）
>
> **要請 (Task):**
>
> 1. このプロジェクトの**NPV（正味現在価値）**を求めるExcelの数式を提示してください。
> 2. **IRR（内部収益率）**を求めるExcelの数式を提示してください。
> 3. 計算結果に基づき、**NPV > 0** または **IRR > 割引率** の場合、投資を実行すべきか見送るべきかの判断基準を分かりやすく説明してください。
>
> **制約事項 (Constraints):**
>
> - Excelの `NPV` 関数を使用する際、初期投資額（0年目）は関数の範囲外とし、1年目以降のキャッシュフローのみを関数に含めて別途加算するという点に注意して数式を作成してください。
> - 出力形式はマークダウンのリスト形式にしてください。
>
> **注意事項 (Warning):**
>
> - 確実ではない情報や憶測は避け、客観的な財務理論に基づいた回答のみを提供してください。（ハルシネーション防止）

---

## 💡 作成者コメント (Insight)

ExcelでNPVを計算する際、最もよくある間違いが「0年目の初期投資額までNPV関数の範囲（Value1, Value2...）に入れてしまう」ことです。ExcelのNPV関数は、範囲の最初の値を「1期目の終わり」として割引計算を始めるため、初期投資額まで割引されてしまい、結果が狂ってしまいます。

このプロンプトでは、AIに「初期投資額は別途処理する」という**制約事項（Constraints）**を明記しているため、AIが間違ったExcelの数式を提示する（ハルシネーション）のを防ぐことができます。実際の業務では、セルの位置や金額をご自身のデータに置き換えるだけで、即座に実務で使える財務モデルが完成します。

---

## 🙋 よくある質問 (FAQ)

- **Q: 毎年の予想収益がバラバラでも計算できますか？**
  - A: はい、可能です。B3からB7セルにそれぞれ異なる金額（例：1年目1000万、2年目2000万...）を入力しても、同じ数式で正確に計算できます。

- **Q: 割引率（要求収益率）はどのように設定すればいいですか？**
  - A: 一般的には、企業の資本コスト（WACC）や、その資金を他の安全な資産（国債など）に投資した場合に得られる利回りを基準に設定します。迷った場合は、自社の財務担当者に確認するか、AIに「IT業界の一般的な割引率の目安は？」と追加で質問してみてください。

---

## 🧬 プロンプト解剖 (Why it works?)

1. **Role（役割）付与:** AIに「財務モデリングの専門家」というペルソナを与えることで、単なる関数の説明ではなく、実務的な投資判断を含んだ質の高い回答を引き出しています。
2. **Context & Data（状況とデータ）の具体化:** 具体的な金額やセルの位置（B2、C2など）を指定することで、AIがそのままコピペして使える正確な数式を生成できるようにしています。
3. **Constraints（制約事項）によるエラー防止:** Excel特有のNPV関数の落とし穴（0年目の扱い）を事前にAIへ指示することで、よくある計算ミスを構造的に防いでいます。

---

## 📊 証明: Before & After

### ❌ Before (入力)

```text
エクセルでNPVとIRRを求める方法を教えて。
```

### ✅ After (結果)

```text
### 📊 投資分析Excel数式

**1. NPV（正味現在価値）の求め方**
- **数式:** `=B2 + NPV(C2, B3:B7)`
- **解釈:** 初期投資額（-1億円）は割引かずにそのまま足し、1年目以降の将来収益のみをNPV関数で現在の価値に割り引くことで正確な値が算出されます。
- **判断基準:** 結果が **0より大きければ** 投資を実行してください。（企業価値を向上させるプロジェクトです）

**2. IRR（内部収益率）の求め方**
- **数式:** `=IRR(B2:B7)`
- **解釈:** IRR関数はNPV関数とは異なり、初期投資額から最終年の収益まで、全期間のキャッシュフローをそのまま範囲指定します。
- **判断基準:** 計算結果（例：15%）が **割引率（10%）よりも高ければ** 投資を実行してください。

**💡 まとめ:**
NPVは「金額（いくら儲かるか）」を、IRRは「率（何％の利回りか）」を示します。両方の基準を満たすプロジェクトが最適な投資先となります。
```

---

## 🎯 結論

投資の意思決定は、勘や経験だけでなく、科学的・論理的な根拠に基づいている必要があります。たった2行のExcel数式を正しく使うことで、何億円もの損失を防ぐことができます。

さあ、賢く計算して、今日も定時で退社しましょう！ 🍷
