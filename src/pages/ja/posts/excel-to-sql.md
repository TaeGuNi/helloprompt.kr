---
layout: /src/layouts/Layout.astro
title: "エクセル地獄から脱出！AIで1秒でSQL変換"
author: "ZZabbis"
date: "2026-02-13"
updatedDate: "2026-02-13"
category: "業務効率化"
description: "乱雑なエクセルデータを正規化されたSQLテーブルスキーマとINSERT文に即座に変換するプロンプトを公開します。"
tags: ["Excel", "SQL", "DB", "AI", "生産性"]
---

# 📝 エクセル地獄から脱出！AIで1秒でSQL変換

<!-- ⚠️ [Lint Rule] 絵文字リストを使用してください。表(Table)はモバイルで崩れる可能性があります。 -->

- **🎯 対象:** エクセルデータをDBに入れる必要があるバックエンドエンジニア、データアナリスト、PM
- **⏱️ 所要時間:** 2時間 → 1分に短縮
- **🤖 推奨モデル:** GPT-4, Claude 3.5 Sonnet, Gemini Pro

- ⭐ **難易度:** ⭐☆☆☆☆
- ⚡️ **効果:** ⭐⭐⭐⭐⭐
- 🚀 **活用度:** ⭐⭐⭐⭐⭐

<!-- ⚠️ [Lint Rule] 引用(>)はBasic/Proセクション以外ではイタリック体(_..._)と一緒に使用しないとエラーになります。 -->

> _"企画者がエクセルでくれたマスターデータ、いつDBに入れるんだ？ カラム名もなんで日本語なんだ..."_

開発者なら誰でも一度は経験したことがあるでしょう。数千行のエクセルデータをSQLに変えるためにエクセル関数(`CONCATENATE`)と格闘したり、CSVに変換して苦労してインポートしたり。これからはAIに任せましょう。データ型の推論から正規化、そして完璧なINSERTクエリ生成まで一度に終わらせることができます。

---

## ⚡️ 3行要約 (TL;DR)

1. エクセルのヘッダーとサンプルデータをコピーするだけでテーブルスキーマ(DDL)を自動生成
2. データ型(INT, VARCHAR, DATETIMEなど)をAIが賢く推論
3. 数千件のデータもフォーマットに合わせてINSERT文(DML)に即座に変換

---

## 🚀 解決策: "Data Alchemist"

<!-- ⚠️ [Lint Rule] 引用(>)はこの場所(Promptセクション)でのみプロンプトボックスに変換されます。 -->

### 🥉 Basic Version (基本形)

単にエクセルデータをSQL INSERT文に変えたい場合に使用してください。

> **役割:** 君はデータベースエンジニアだ。
> **リクエスト:** 下のエクセルデータを[MySQL/PostgreSQL]の文法に合う`CREATE TABLE`と`INSERT`文に変換してくれ。カラム名は英語に適切に変換して。

<br>

### 🥇 Pro Version (専門家形)

データ正規化、型最適化、制約条件まで考慮した完璧なクエリが必要な場合に使用してください。

> **役割 (Role):**
> あなたはデータモデリングとSQL最適化に精通した**シニアデータベース管理者(DBA)**です。汚れて整理されていない生データ(Raw Data)を分析し、効率的なRDBMS構造に設計する能力に優れています。
>
> **状況 (Context):**
> エクセル(またはCSV)形式の非定型データが与えられました。このデータはカラム名が日本語だったり曖昧だったりする可能性があり、データ型が明示されていません。これを実際の運用環境(Production)にすぐに適用できるSQLスクリプトに変換する必要があります。
>
> **リクエスト (Task):**
> 提供されたデータを分析し、次のステップに従ってSQLスクリプトを作成してください。
>
> 1.  **データ分析 (Analyze):** 各カラムのデータ例を見て適切なデータ型(INTEGER, VARCHAR, BOOLEAN, DATEなど)を推論してください。`NULL`許容かどうかも判断してください。
> 2.  **スキーマ設計 (DDL):**
>     - 直感的な英語のカラム名にマッピングしてください(例: '顧客名' -> `customer_name`)。
>     - 適切なPrimary Key(PK)を選定するか、必要なら`id`カラムを追加してください。
>     - `CREATE TABLE`文を作成してください。(コメントで元のカラム名を明示してください)。
> 3.  **データ変換 (DML):**
>     - 提供されたデータに基づいて`INSERT INTO`文を作成してください。
>     - 日付形式がバラバラなら標準フォーマット('YYYY-MM-DD')に統一してください。
>     - 文字列に含まれる引用符(')などを適切にエスケープ処理してください。
>
> **制約事項 (Constraints):**
>
> - **DBMS:** MySQL 8.0互換の文法を使用してください。(またはユーザーが指定したDB)
> - **命名規則:** snake_caseを使用してください。
> - **最適化:** `VARCHAR`の長さはデータ長を考慮して余裕を持って設定しますが、無駄にしないでください(例: `VARCHAR(255)`の乱用禁止)。
>
> **入力データ:**
> ```[ここにエクセル/CSVデータを貼り付けてください]```

---

<!-- ✅ [Lint Rule] 必須セクションです。欠落するとCIエラーが発生します。 -->

## 💡 作成者コメント (Insight)

このプロンプトの強力な点は、単にテキストを変えるのではなく**「モデリング」**を実行するという点です。
AIはデータ値(例: '090-1234-5678')を見て「あ、これは電話番号だから文字列で、長さは20文字あれば十分だな」と判断します。また「使用可否」のようなカラムに'Y', 'N'が入っていれば、これを`ENUM`や`TINYINT`に最適化して提案したりもします。単純作業を高次元の設計作業に変えてくれるツールです。

---

<!-- ⚠️ [Lint Rule] 推奨セクションです。欠落すると警告が発生します。 -->

## 🙋 よくある質問 (FAQ)

- **Q: データが数千件ありますが全部入りますか？**
  - A: LLMのコンテキストウィンドウの限界があります。スキーマ(DDL)生成は全体のヘッダーとサンプル10行で行い、INSERT文(DML)生成はデータを100〜500行ずつ分けてリクエストするのが良いでしょう。

- **Q: 他のDBもサポートしていますか？**
  - A: はい、制約事項のDBMS項目を'Oracle', 'SQL Server', 'PostgreSQL'などに変えれば、その文法に合わせて生成してくれます。

---

## 🧬 プロンプト解剖 (Why it works?)

1.  **Role付与:** 'シニアDBA'という役割を与え、データ型選定とネーミングに専門性を加えました。
2.  **Step-by-Step:** 分析 -> 設計 -> 変換の過程を明示し、論理的な結果を作ります。
3.  **Data Cleaning:** 日付フォーマット統一やエスケープ処理のようなディテールな要求事項を通じて実行エラーを防止します。

---

## 📊 証明: Before & After

### ❌ Before (入力: エクセルコピペ)

```text
名前    入社日       職級    年俸
佐藤    2023.03.01  代理    5000
鈴木    2024-01-02  社員    3500
田中    23/12/01    課長    6500
```

### ✅ After (結果)

```sql
-- Employeesテーブル作成
CREATE TABLE employees (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL COMMENT '名前',
    joined_at DATE NOT NULL COMMENT '入社日',
    position VARCHAR(20) NOT NULL COMMENT '職級',
    salary INT NOT NULL COMMENT '年俸'
);

-- データ挿入
INSERT INTO employees (name, joined_at, position, salary) VALUES
('佐藤', '2023-03-01', '代理', 5000),
('鈴木', '2024-01-02', '社員', 3500),
('田中', '2023-12-01', '課長', 6500);
```

---

## 🎯 結論

データ移行や初期ダミーデータ構築にかける時間を劇的に減らしてみましょう。エクセルを開いて`CONCAT`関数を書く代わりに、プロンプト一つで定時退社が近づきます。
