---
layout: /src/layouts/Layout.astro
title: "Query SQL Lenta, O Segredo do Tuning em 3 Segundos"
author: "Zzabbis"
date: "2026-02-04"
updatedDate: "2026-02-04"
category: "Desenvolvimento"
description: "Um prompt que analisa consultas SQL complexas e ineficientes, otimiza o desempenho e recomenda Ã­ndices."
tags: ["SQL", "Tuning de DB", "OtimizaÃ§Ã£o de Query", "Banco de Dados"]
lang: pt
---

# ğŸ“ Query SQL Lenta, O Segredo do Tuning em 3 Segundos

> **ğŸ¯ Recomendado para:** Todos
> **â±ï¸ Tempo necessÃ¡rio:** 5 minutos
> **ğŸ¤– Modelo recomendado:** Todos os modelos de IA

| Dificuldade |  EficÃ¡cia  | Utilidade |
| :---------: | :--------: | :-------: |
|   â­â­â˜†â˜†â˜†   | â­â­â­â­â­ | â­â­â­â­â˜† |

_"Demora 5 segundos para consultar assim que os dados aumentam um pouco..."_

A query que era rÃ¡pida no inÃ­cio se torna uma tartaruga Ã  medida que os dados crescem.
Olhar para o Plano de ExecuÃ§Ã£o (Explain Plan) e ver tudo preto e branco te deixava perdido?
Mostre a query para a IA e ela encontrarÃ¡ as partes ineficientes e atÃ© recomendarÃ¡ Ã­ndices mÃ¡gicos.

---

## âš¡ï¸ 3ì¤„ ìš”ì•½ (TL;DR)

1. Melhoria de Joins ineficientes e subqueries
2. RecomendaÃ§Ã£o de Ã­ndices necessÃ¡rios
3. Reescrita com sintaxe SQL moderna e legÃ­vel

---

## ğŸš€ SoluÃ§Ã£o: "Tuner de Query SQL"

### ğŸ¥‰ VersÃ£o BÃ¡sica

Use quando precisar apenas de resultados rÃ¡pidos.

> **Papel:** VocÃª Ã© um DBA (Database Administrator) SÃªnior com 20 anos de experiÃªncia e especialista em Tuning de SQL.
> **Tarefa:** Analise consultas SQL complexas e ineficientes, otimize o desempenho e recomende Ã­ndices.

<br>

### ğŸ¥‡ VersÃ£o Pro (Especialista)

Use quando precisar de qualidade detalhada.

Copie o conteÃºdo do **PROMPT** abaixo e cole no ChatGPT ou Claude.

> **Papel:** VocÃª Ã© um DBA (Database Administrator) SÃªnior com 20 anos de experiÃªncia e especialista em Tuning de SQL.
>
> **SituaÃ§Ã£o:** A consulta SQL usada na minha aplicaÃ§Ã£o estÃ¡ causando degradaÃ§Ã£o de desempenho Ã  medida que a quantidade de dados aumenta.
>
> **Tarefa:**
> Analise a consulta SQL fornecida abaixo e realize as seguintes tarefas:
>
> 1. **DiagnÃ³stico de Problemas:** Aponte as partes que podem causar degradaÃ§Ã£o de desempenho na consulta atual (Full Table Scan, etc.).
> 2. **OtimizaÃ§Ã£o de Consulta:** Reescreva a consulta para retornar o mesmo resultado, mas funcionando de forma mais eficiente.
> 3. **RecomendaÃ§Ã£o de Ãndice:** Sugira em quais colunas criar Ã­ndices para maximizar o desempenho da consulta com a sintaxe `CREATE INDEX`.
>
> **DB em uso:** `[MySQL / PostgreSQL / Oracle / MS-SQL]`
>
> **Consulta Alvo:**
>
> ```sql
> [Cole aqui a consulta lenta]
> ```
>
> **RestriÃ§Ãµes:**
>
> - O conjunto de dados resultante da consulta original nunca deve ser alterado.
> - Explique brevemente o princÃ­pio de execuÃ§Ã£o de por que ficou mais rÃ¡pido.

---

## ğŸ§¬ AnÃ¡lise do Prompt (Por que funciona?)

---

## ğŸ“Š Prova: Antes e Depois

### âŒ Antes (Consulta de entrada)

```sql
SELECT * FROM users
WHERE id IN (SELECT user_id FROM orders WHERE price > 10000);
```

_Problema: A subquery pode ser executada para cada linha (Dependent Subquery)._

### âœ… Depois (Resultado)

**Consulta Otimizada (Usando JOIN):**

```sql
SELECT DISTINCT u.*
FROM users u
INNER JOIN orders o ON u.id = o.user_id
WHERE o.price > 10000;
```

**Ãndice Recomendado:**

```sql
CREATE INDEX idx_orders_price_userid ON orders(price, user_id);
```

_ExplicaÃ§Ã£o: Alterou a subquery para JOIN para otimizaÃ§Ã£o e criou um Ã­ndice composto para filtrar por `price` e depois fazer o join por `user_id`._

---

## ğŸ¯ ConclusÃ£o

Dizem que "Tuning Ã© arte", mas agora Ã© uma 'ciÃªncia' que pode receber ajuda da IA.
NÃ£o sofra com queries lentas, receba uma consultoria gratuita do DBA IA! ğŸ·
