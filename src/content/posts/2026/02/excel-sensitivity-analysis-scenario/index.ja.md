---
layout: /src/layouts/Layout.astro
title: "エクセル感度分析：「もしも」のシナリオ完璧備え"
author: "Zzabbis"
date: "2026-02-04"
updatedDate: "2026-02-04"
category: "業務自動化"
description: "為替レートが10%上がれば利益はどれくらい減るのか？エクセルのデータテーブル機能を使って、数十種類のシナリオを一度に計算します。"
tags: ["エクセル", "感度分析", "シナリオ", "データ表"]
---

# 📝 エクセルの感度分析：「もしも」のシナリオに完璧に備える

- **🎯 推奨対象:** マーケター、経営企画担当者、すべてのエクセルユーザー
- **⏱️ 所要時間:** 30分 → 1分に短縮
- **🤖 推奨モデル:** すべての対話型AI (ChatGPT, Claude, Geminiなど)

- ⭐ **難易度:** ⭐⭐☆☆☆
- ⚡️ **効果性:** ⭐⭐⭐⭐⭐
- 🚀 **活用度:** ⭐⭐⭐⭐☆

> _「未来を完全に予測することはできませんが、すべての可能性を計算しておくことは可能です。」_

事業計画を立てる際、最も重要なのは「変数」です。為替レート、原材料価格、販売量などの条件が変わったとき、営業利益がどのように変動するかを一目で確認できる**「感度分析 (Sensitivity Analysis)」**マトリックス。エクセルの隠れた強力な機能である**「データテーブル (Data Table)」**を活用すれば、たった一つの数式で100種類のシナリオを自動計算できます。

---

## ⚡️ 3行要約 (TL;DR)

1. 変数（為替レート、販売量など）と結果値（営業利益）の連動関係を構築する。
2. エクセルの「What-If 分析 > データテーブル」機能を活用してマトリックスを生成する。
3. 2つの変数が同時に変動した際の結果をシミュレーションし、リスクに備える。

---

## 🚀 解決策：「シナリオマトリックス生成プロンプト」

### 🥉 Basic Version (基本形)

素早く手順だけを知りたい場合に使用してください。

> **役割:** あなたは経営企画室の`[財務モデリング専門家]`です。
> **要請:** 為替レートが10%上がった場合、利益がどれくらい減少するかを知りたいです。エクセルの「データテーブル」機能を使って、数十種類のシナリオを一度に計算する手順を教えてください。

<br>

### 🥇 Pro Version (専門家形)

より詳細で実践的なガイドが必要な場合に使用してください。

> **役割 (Role):** あなたは経営企画室の`[財務モデリング専門家]`です。
>
> **状況 (Context):**
>
> - 背景: エクセルで**感度分析 (Sensitivity Analysis)**を作成しようとしています。
> - 目標: 「営業利益」の変動を可視化すること。
> - 変数 1 (行): 為替レート (1,200円 ～ 1,400円、50円刻み)
> - 変数 2 (列): 販売量 (1万個 ～ 5万個、1万個刻み)
>
> **要請 (Task):**
>
> 1. エクセルの**「データテーブル (Data Table)」**機能を使用する手順を、ステップバイステップで詳しく教えてください。
> 2. 「行の代入セル」と「列の代入セル」をそれぞれどこにリンクさせるべきか、初心者が混乱しないように分かりやすく説明してください。
> 3. 完成した表から、「為替レートが上がると利益が急減するため、為替ヘッジが必要だ」といったビジネスインサイトを導き出すためのヒントを提供してください。
>
> **制約事項 (Constraints):**
>
> - エクセルのメニューパス（[データ] タブ > [What-If 分析] > [データテーブル]）を正確に明記してください。
> - 出力形式は読みやすいマークダウンで作成してください。
>
> **注意事項 (Warning):**
>
> - 不確実なエクセルのショートカットや機能はでっち上げず、正確な情報のみを提供してください。（ハルシネーション防止）

---

## 💡 作成者のコメント (Insight)

エクセルの「データテーブル」機能は、経営陣からの突発的な「もしこうなったらどうなる？」という質問に即答するための最強の武器です。多くの方が一つひとつのケースを手作業で計算（ハードコーディング）していますが、この機能を使えば変数を変えるだけで結果がリアルタイムに更新されます。AIに「行」と「列」の概念を分かりやすく説明させることで、これまで設定に悩んでいた時間を劇的に短縮できます。特に、条件付き書式（カラースケール）と組み合わせることで、赤字に転落する「デッドライン」を視覚的に把握できる点が非常に強力です。

---

## 🙋 よくある質問 (FAQ)

- **Q: 3つ以上の変数を同時に分析することはできますか？**
  - A: エクセルのデータテーブル機能は最大2つの変数（行と列）までしか対応していません。3つ以上の変数を分析する場合は、「シナリオの登録と管理（Scenario Manager）」機能を使用するか、AIに「3変数の感度分析を行うためのVBAコードを書いて」とリクエストしてみてください。

- **Q: データテーブルの計算結果がすべて同じ値になってしまいます。なぜですか？**
  - A: エクセルの計算オプションが「データテーブル以外自動」または「手動」になっている可能性があります。`[数式]` タブ > `[計算方法の設定]` で `[自動]` にチェックが入っているか確認してください。

---

## 🧬 プロンプト解剖 (Why it works?)

1.  **状況と変数の具体化:** 分析の目的（営業利益）と2つの変数（為替レート、販売量）の範囲と単位を明確に指定することで、AIが具体的な数値を基にした説明を行えるようにしました。
2.  **つまずきポイントの事前指定:** 初心者が最もミスをしやすい「行の代入セル」と「列の代入セル」の指定方法について、重点的に説明するよう指示し、実務でのエラーを未然に防ぎます。
3.  **インサイトの要求:** 単なる操作方法の解説にとどまらず、結果からどのようなビジネス的示唆（例：為替ヘッジの必要性）を得るべきかまでAIに提示させることで、分析の付加価値を高めています。

---

## 📊 証明: Before & After

### ❌ Before (入力)

```text
エクセルで為替変動のシナリオってどうやって作るの？
```

### ✅ After (結果)

```text
### 🌪️ エクセルの感度分析 3ステップガイド

**1. 準備（マトリックス構造の作成）**
- A列（縦）に**為替レート**のシナリオ（1200, 1250, 1300...）を入力します。
- 1行目（横）に**販売量**のシナリオ（1万, 2万, 3万...）を入力します。
- **重要:** A列と1行目が交差する**左上の角（A1セル）**に、必ず**「営業利益を計算する数式（例: =C10）」**をリンクさせる必要があります。

**2. 実行（データテーブルの適用）**
- 数式セル（A1）を含め、入力したシナリオの範囲全体をドラッグして選択します。
- `[データ]` タブ ➔ `[What-If 分析]` ➔ `[データテーブル]` をクリックします。
- **行の代入セル:** 元データ（計算の基礎となる表）の**「販売量」**の入力セルをクリックします。（シナリオが横方向に並んでいるため）
- **列の代入セル:** 元データ（計算の基礎となる表）の**「為替レート」**の入力セルをクリックします。（シナリオが縦方向に並んでいるため）

**3. 結果の確認と分析**
- 「OK」を押した瞬間、表の空白部分に数十パターンの営業利益の予測値が一瞬で自動計算されます。
- **💡 プロのヒント:** 結果のセル範囲に「条件付き書式（カラースケール）」を適用してみてください。利益がマイナス（赤字）に転じる境界線が一目で分かり、リスク管理（為替ヘッジなど）の意思決定に直結します。
```

---

## 🎯 結論

役員会議で「もし為替が1,350円になったら利益はどうなる？」と突然聞かれても、もう慌てる必要はありません。エクセルの表の「1350」と「販売量」が交差する数値を読み上げるだけです。これこそが「準備された人材」の姿です。

これで今日の業務は終了です。定時で退社しましょう！ 🍷
