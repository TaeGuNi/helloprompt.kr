---
layout: /src/layouts/Layout.astro
title: "私のコードがゴミだって！？クリーンコード・リファクタリング・コーチ"
author: "Zzabbis"
date: "2026-02-07T09:10:33.120Z"
updatedDate: "2026-02-07T09:10:33.120Z"
category: "コーディング/IT"
description: "動くだけのスパゲッティコードを、「読みやすく、保守しやすい」クリーンなコードに劇的にアップグレードするリファクタリング用プロンプトです。"
tags: ["リファクタリング", "クリーンコード", "開発者", "コードレビュー"]
---

# 📝 私のコードがゴミだって！？クリーンコード・リファクタリング・コーチ

- **🎯 推奨対象:** ジュニア〜ミドルエンジニア、コードレビューに時間を奪われているシニアエンジニア
- **⏱️ 所要時間:** 30分 → 1分に短縮
- **🤖 推奨モデル:** Claude 3.5 Sonnet (コーディング特化), GPT-4o

- ⭐ **難易度:** ⭐⭐☆☆☆
- ⚡️ **効果:** ⭐⭐⭐⭐⭐
- 🚀 **活用度:** ⭐⭐⭐⭐☆

> _「とりあえず動くからヨシ！」と妥協して数ヶ月。今や誰も触れたがらない"パンドラの箱"になっていませんか？_

スパゲッティコードは、開発スピードを低下させる最大の元凶です。可読性が低いコードはバグの温床となり、新機能の追加すら命がけの作業に変えてしまいます。このプロンプトは、名著『Clean Code』の著者ロバート・C・マーティンの思考プロセスをAIに憑依させ、あなたのコードを根本から洗い直してピカピカに磨き上げます。

---

## ⚡️ 3行要約 (TL;DR)

1. **命名規則の最適化:** 意味不明な変数名を、直感的で意図が伝わる名前に変更します。
2. **関数の単一責任化:** 肥大化した長すぎる関数を、役割ごとに小さく分割（Extract Method）します。
3. **最新構文の適用:** 古い書き方を排除し、言語の最新機能（Modern Syntax）を活用した簡潔なコードに変換します。

---

## 🚀 解決策: "クリーンコード・リファクタリング"

### 🥉 Basic Version (基本型)

手っ取り早く、とりあえず全体をきれいに整えたい時に使用してください。

> **役割:** あなたは `[経験豊富なシニア・ソフトウェアアーキテクト]` です。
> **リクエスト:** 以下のコードは動作しますが、可読性が低く保守が困難です。クリーンコードの原則に従って、読みやすく保守しやすいコードにリファクタリングしてください。

<br>

### 🥇 Pro Version (専門家型)

実務レベルでの厳密なコードレビューと、リファクタリングの「根拠」までしっかり理解したい時に使用してください。

> **役割 (Role):** あなたは『Clean Code』の原則を熟知した `[シニア・ソフトウェアアーキテクト]` です。
>
> **状況 (Context):**
>
> - 背景: 現在のコードは要件を満たして動作していますが、技術的負債（Dirty Code）が蓄積しており、他の開発者が理解するのに時間がかかります。
> - 目標: チーム全体が保守しやすく、テストが容易で、拡張性の高いコードに改善すること。
>
> **リクエスト (Task):**
>
> 1. **[ネーミングの改善]**: 変数名や関数名を、その役割が明確に伝わる直感的な名前に変更してください。（例: `d` -> `elapsedTimeInDays`）
> 2. **[構造の最適化]**: 「1つの関数は1つのことだけを行う」という原則に従い、肥大化した関数を適切に分割し、重複ロジックを排除してください。
> 3. **[最新構文の適用]**: 可能であれば、対象言語（例: `[Python 3.12 / ES2023 など言語を指定]`）の最新かつ安全な構文を適用し、より簡潔に記述してください。
> 4. **[Before & Afterの解説]**: 修正箇所を具体的に明示し、「なぜそのように変更したのか」というアーキテクチャ上の理由をMarkdownのリスト形式で論理的に説明してください。
>
> **制約事項 (Constraints):**
>
> - コードの既存の「動作（ビジネスロジック）」は絶対に変更しないでください。
> - コメントは、コード自体で意図を表現できない「どうしても必要な箇所（Why）」にのみ記述してください。不要な説明コメント（What）はすべて削除してください。
> - 出力は、解説とリファクタリング後の完全なコードブロックを含めてください。
>
> **対象コード (Target Code):**
>
> ```[対象の言語]
> (ここにリファクタリングしたいコードを貼り付けてください)
> ```

---

## 💡 作成者コメント (Insight)

このプロンプトの真の価値は、単にコードをきれいにすることではなく**「シニアエンジニアのコードレビューを擬似体験できること」**にあります。
出力された「なぜ変更したのか」という解説（Before & Afterの解説）を読むことで、あなた自身のコーディングスキルも自然と向上します。実務では、プルリクエスト（PR）を作成する前に一度このプロンプトを通すだけで、レビュアーからの指摘（Nitpick）を劇的に減らすことができ、チーム全体の生産性向上に直結します。

---

## 🙋 よくある質問 (FAQ)

- **Q: リファクタリングによってバグが発生したり、動作が変わったりしませんか？**
  - A: プロンプト内で「動作は絶対に変更しないこと」と強く制約をかけていますが、AIが意図せずロジックを変えてしまうリスクはゼロではありません。必ず**ユニットテスト**を実行して、修正前後で挙動が変わっていないことを確認してください。

- **Q: 会社の大規模な社内システムのコードを丸ごと貼り付けても大丈夫ですか？**
  - A: 絶対におやめください。機密情報や社外秘のビジネスロジックが含まれるコードを、公開されているAIモデルに入力することはセキュリティ違反になる可能性があります。関数のロジック部分だけを切り出すか、変数名をダミーに置き換えた上で使用してください。

- **Q: どのAIモデルを使用するのが一番結果が良いですか？**
  - A: コーディングタスクにおいては、現時点では **Claude 3.5 Sonnet** が圧倒的に優秀です。コンテキストの理解力が高く、意図を汲み取った美しいリファクタリングを提案してくれます。

---

## 🧬 プロンプト解剖 (Why it works?)

1.  **Role（役割の付与）:** 「シニアアーキテクト」というペルソナを与えることで、AIの回答基準を「単に動くコード」から「保守性と拡張性の高いコード」へと引き上げます。
2.  **Constraints（制約による暴走防止）:** 「動作を変えない」「不要なコメントは消す」という厳しい制約を設けることで、AIが勝手に不要な機能を追加したり、冗長なコメントでコードを汚したりする（Hallucination）のを防いでいます。
3.  **Task（論理的思考の誘導）:** 修正するだけでなく「なぜ修正したのか」を説明させることで、Chain-of-Thought（段階的思考）が促され、より論理的で精度の高いリファクタリング結果が導き出されます。

---

## 📊 証明: Before & After

### ❌ Before (入力)

```python
def calc(x, y):
    if x > 19:
        print("成人")
        p = y * 0.9
        return p
    else:
        print("学生")
        return y
```

_(関数名 `calc` からは何の計算か推測できず、変数 `p` も意味不明。またマジックナンバー `19` や `0.9` が直書きされている)_

### ✅ After (結果)

```python
def calculate_discounted_price(age: int, price: float) -> float:
    ADULT_AGE_THRESHOLD = 20
    DISCOUNT_RATE = 0.9

    if age >= ADULT_AGE_THRESHOLD:
        print("成人です。")
        return price * DISCOUNT_RATE

    print("学生です。")
    return price
```

**[改善ポイントの解説]**

1. **関数・変数名の明確化**: `calc` -> `calculate_discounted_price` へ変更し、引数にも型ヒント（Type Hinting）を追加しました。
2. **マジックナンバーの排除**: `20` や `0.9` などの数値に定数名 (`ADULT_AGE_THRESHOLD`, `DISCOUNT_RATE`) を与え、意図を明確にしました。
3. **早期リターン (Early Return)**: 不要な `else` ブロックを削除し、ネスト（インデント）を浅くして可読性を向上させました。

---

## 🎯 結論

優れたコードは、よく推敲されたエッセイのように、読み手の頭にスッと入ってきます。
AIを強力なペアプログラミングの相棒として活用し、未来の自分（そして同僚）のために、コードの負債を今すぐ清算しましょう。

さあ、負債を返済して定時退社しましょう。リファクタリングの沼にハマる前に！ 🍷
